This is a problem from StackOverflow's algorithm board, IMHO not quite complex, yet if you want to make it perfect, there're still something to be done, and also in improving performance. I put detailed information about this problem, please refer to the code for details.
 